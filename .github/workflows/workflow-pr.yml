name: Workflow for PRs
run-name: Running my first workflow for PRs
permissions:
  contents: read
  pull-requests: write
on:
  pull_request:
    branches: [main]
jobs:
  check-lines-of-code:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Get lines of code added and removed
        id: diff
        uses: actions/github-script@v6
        env:
          ADDITIONS: ${{ steps.diff.outputs.additions }}
          DELETIONS: ${{ steps.diff.outputs.deletions }}
          TOTAL_CHANGES: ${{ steps.diff.outputs.totalChanges }}
        with:
          script: |
            const additions = process.env.ADDITIONS;
            const deletions = process.env.DELETIONS;
            const totalChanges = process.env.TOTAL_CHANGES;

            const commentBody = `
            ### üìä Code Changes Summary
            | Lines Added | Lines Removed | Total Changes |
            |-------------|---------------|---------------|
            | ${additions} | ${deletions} | ${totalChanges} |

            ${
              totalChanges > 500
                ? "‚ùå **Too many changes! The PR exceeds the limit of 500 lines.**"
                : "‚úÖ **The PR is within the acceptable limit.**"
            }
            `;

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.pull_request.number,
              body: commentBody,
            });
